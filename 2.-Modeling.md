Modeling, Plotting and Regression Tables
================
Mykola Dereva
June 11, 2020

load our cleaned data

``` r
analysis_full <- readRDS(here("data", "clean data", "Analysis_data.Rds"))
```

## Remove Outliers

lets look on the possible outliers

There are few MP values which are considerable higher or lower then
other. This might influence the reliability of research. Thus, I will
drop them

``` r
analysis <- analysis_full %>%
  filter(between(index, 0.005, 1))  
```

## Analysis

Select only columns we need for the analysis. Rename columns once again.
And create columns with dummy variables

``` r
glimpse(analysis)
```

    ## Rows: 459
    ## Columns: 31
    ## $ index              <dbl> 0.17600, 0.08900, 0.01100, 0.03684, 0.40190, 0.2...
    ## $ obs_n              <dbl> 60, 60, 60, 24, 24, 23, 23, 120, 108, 28, 48, 15...
    ## $ after_2005         <dbl> 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ perish             <dbl> 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, ...
    ## $ mean_pse           <dbl> 34.73444, 34.73444, 34.73444, NaN, NaN, NaN, NaN...
    ## $ mean_pp            <dbl> 1.352539, 1.352539, 1.352539, NaN, NaN, NaN, NaN...
    ## $ sfarm_share        <dbl> 19.69004, 19.69004, 19.69004, NaN, NaN, NaN, NaN...
    ## $ sfarm_share_by_cat <dbl> 8.917172, 8.917172, 8.917172, NaN, NaN, NaN, NaN...
    ## $ start_business     <dbl> 73.24874, 73.24874, 73.24874, NaN, NaN, NaN, NaN...
    ## $ edb_index          <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN...
    ## $ weights            <dbl> 0.25000000, 0.25000000, 0.25000000, 0.50000000, ...
    ## $ freq_Monthly       <int> 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, ...
    ## $ freq_Yearly        <int> 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, ...
    ## $ freq_Quaterly      <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ freq_Weekly        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ type_Oligopsony    <int> 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, ...
    ## $ type_Oligopoly     <int> 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, ...
    ## $ ind_meat           <int> 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ ind_tobacco        <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, ...
    ## $ ind_beverages      <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, ...
    ## $ ind_dairy          <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...
    ## $ ind_oils           <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ ind_fruits         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ ind_cereals        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ ind_other          <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, ...
    ## $ count_europe       <int> 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, ...
    ## $ count_n_america    <int> 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, ...
    ## $ count_other        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
    ## $ app_GIM            <int> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, ...
    ## $ app_PTA            <int> 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, ...
    ## $ app_SFA            <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...

``` r
analysis %>%
  summarise_all(~ sum(is.na(.x))) %>%
  gather(column, n_na)
```

    ## # A tibble: 31 x 2
    ##    column              n_na
    ##    <chr>              <int>
    ##  1 index                  0
    ##  2 obs_n                  0
    ##  3 after_2005             0
    ##  4 perish                 0
    ##  5 mean_pse               9
    ##  6 mean_pp                9
    ##  7 sfarm_share          256
    ##  8 sfarm_share_by_cat   258
    ##  9 start_business       140
    ## 10 edb_index            198
    ## # ... with 21 more rows

``` r
log_lm <- lm(log(index) ~ app_PTA + app_GIM 
               #+ obs_n + I(obs_n^2) 
               + log(obs_n) 
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals
               + perish
               #+ log(mean_pse)*type_Oligopsony
               #+ log(mean_pp)
               #+ log(mean_pse)*log(mean_pp)
               #+ log(mean_pse)*count_n_america
               #+ perish*count_n_america
               #+ perish*type_Oligopsony
                 , 
         data = analysis)

summary(log_lm)
```

    ## 
    ## Call:
    ## lm(formula = log(index) ~ app_PTA + app_GIM + log(obs_n) + freq_Yearly + 
    ##     count_n_america + count_europe + after_2005 + type_Oligopsony + 
    ##     ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils + 
    ##     ind_fruits + ind_cereals + perish, data = analysis)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -2.6126 -0.3967 -0.0145  0.4463  2.1965 
    ## 
    ## Coefficients:
    ##                  Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)     -0.418802   0.536379  -0.781 0.435341    
    ## app_PTA          0.465444   0.182120   2.556 0.010931 *  
    ## app_GIM         -0.374509   0.173080  -2.164 0.031016 *  
    ## log(obs_n)      -0.539882   0.089676  -6.020 3.66e-09 ***
    ## freq_Yearly     -0.783047   0.229095  -3.418 0.000689 ***
    ## count_n_america  0.542352   0.171812   3.157 0.001705 ** 
    ## count_europe     0.004201   0.145752   0.029 0.977016    
    ## after_2005      -0.080025   0.185558  -0.431 0.666486    
    ## type_Oligopsony -0.004006   0.078679  -0.051 0.959417    
    ## ind_meat         0.565488   0.190106   2.975 0.003095 ** 
    ## ind_tobacco      0.396809   0.218378   1.817 0.069883 .  
    ## ind_beverages    0.170178   0.138460   1.229 0.219695    
    ## ind_dairy        0.472511   0.175304   2.695 0.007299 ** 
    ## ind_oils        -0.146507   0.161057  -0.910 0.363496    
    ## ind_fruits       0.529038   0.194196   2.724 0.006700 ** 
    ## ind_cereals      0.169897   0.121829   1.395 0.163850    
    ## perish          -0.449822   0.176618  -2.547 0.011208 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.6667 on 442 degrees of freedom
    ## Multiple R-squared:  0.3212, Adjusted R-squared:  0.2966 
    ## F-statistic: 13.07 on 16 and 442 DF,  p-value: < 2.2e-16

``` r
bptest(log_lm)
```

    ## 
    ##  studentized Breusch-Pagan test
    ## 
    ## data:  log_lm
    ## BP = 103.85, df = 16, p-value = 6.545e-15

``` r
plot(log_lm)
```

![](2.-Modeling_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-8-2.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-8-3.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-8-4.png)<!-- -->

seems that we have hetoroscadasticity issue. Lets try to use
heteroscadasticity robust se and to compare it with the regular

``` r
log_lm_se <- vcovHC(log_lm, type = "HC")
log_lm_se <- sqrt(diag(log_lm_se))



stargazer(log_lm, log_lm, se = list(NULL, log_lm_se),
          column.labels = c("default SE", "robust SE"), type = "text",
          omit.stat = c("f", "ser", "n"), align = TRUE)
```

    ## 
    ## ============================================
    ##                     Dependent variable:     
    ##                 ----------------------------
    ##                          log(index)         
    ##                   default SE     robust SE  
    ##                      (1)            (2)     
    ## --------------------------------------------
    ## app_PTA            0.465**        0.465**   
    ##                    (0.182)        (0.234)   
    ##                                             
    ## app_GIM            -0.375**       -0.375*   
    ##                    (0.173)        (0.220)   
    ##                                             
    ## log(obs_n)        -0.540***      -0.540***  
    ##                    (0.090)        (0.099)   
    ##                                             
    ## freq_Yearly       -0.783***      -0.783***  
    ##                    (0.229)        (0.279)   
    ##                                             
    ## count_n_america    0.542***      0.542***   
    ##                    (0.172)        (0.188)   
    ##                                             
    ## count_europe        0.004          0.004    
    ##                    (0.146)        (0.154)   
    ##                                             
    ## after_2005          -0.080        -0.080    
    ##                    (0.186)        (0.244)   
    ##                                             
    ## type_Oligopsony     -0.004        -0.004    
    ##                    (0.079)        (0.073)   
    ##                                             
    ## ind_meat           0.565***      0.565***   
    ##                    (0.190)        (0.169)   
    ##                                             
    ## ind_tobacco         0.397*        0.397*    
    ##                    (0.218)        (0.207)   
    ##                                             
    ## ind_beverages       0.170          0.170    
    ##                    (0.138)        (0.166)   
    ##                                             
    ## ind_dairy          0.473***      0.473***   
    ##                    (0.175)        (0.163)   
    ##                                             
    ## ind_oils            -0.147        -0.147    
    ##                    (0.161)        (0.175)   
    ##                                             
    ## ind_fruits         0.529***      0.529***   
    ##                    (0.194)        (0.173)   
    ##                                             
    ## ind_cereals         0.170          0.170    
    ##                    (0.122)        (0.156)   
    ##                                             
    ## perish             -0.450**      -0.450***  
    ##                    (0.177)        (0.168)   
    ##                                             
    ## Constant            -0.419        -0.419    
    ##                    (0.536)        (0.642)   
    ##                                             
    ## --------------------------------------------
    ## R2                  0.321          0.321    
    ## Adjusted R2         0.297          0.297    
    ## ============================================
    ## Note:            *p<0.1; **p<0.05; ***p<0.01

``` r
get_robust_se <- function(lm_model)  {
  matrix <- vcovHC(lm_model, type = "HC0")
  robust_se <- sqrt(diag(matrix))
  return(robust_se)
}
```

## Robust Linear Regression

``` r
rlm <- MASS::rlm( formula(log_lm), 
         data = analysis,
         maxit = 100,
         psi = "psi.bisquare") # give lowest RSS

summary(rlm)
```

    ## 
    ## Call: rlm(formula = formula(log_lm), data = analysis, maxit = 100, 
    ##     psi = "psi.bisquare")
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2.77744 -0.35665 -0.05053  0.36742  1.82289 
    ## 
    ## Coefficients:
    ##                 Value   Std. Error t value
    ## (Intercept)      0.2052  0.4999     0.4105
    ## app_PTA          0.6181  0.1697     3.6418
    ## app_GIM         -0.0977  0.1613    -0.6059
    ## log(obs_n)      -0.6879  0.0836    -8.2315
    ## freq_Yearly     -0.9509  0.2135    -4.4537
    ## count_n_america  0.4993  0.1601     3.1184
    ## count_europe    -0.0838  0.1358    -0.6169
    ## after_2005       0.0486  0.1729     0.2813
    ## type_Oligopsony -0.1092  0.0733    -1.4893
    ## ind_meat         0.6005  0.1772     3.3896
    ## ind_tobacco      0.2813  0.2035     1.3824
    ## ind_beverages    0.1194  0.1290     0.9255
    ## ind_dairy        0.4846  0.1634     2.9664
    ## ind_oils        -0.3484  0.1501    -2.3214
    ## ind_fruits       0.5955  0.1810     3.2902
    ## ind_cereals     -0.0025  0.1135    -0.0223
    ## perish          -0.5884  0.1646    -3.5748
    ## 
    ## Residual standard error: 0.5379 on 442 degrees of freedom

``` r
get_r2 <- function(model){  
 SSe <- sum((model$resid)^2)
 observed <- model$resid + model$fitted
 SSt <- sum((observed - mean(observed))^2)
 value <- 1 - SSe/SSt
 return(value)
}
```

``` r
get_r2(rlm)
```

    ## [1] 0.2961097

``` r
log_lm_se <- get_robust_se(log_lm)
rlm_se <- get_robust_se(rlm)

stargazer(rlm, log_lm, se = list(rlm_se, log_lm_se),
          type = "text",
          align = TRUE)
```

    ## 
    ## =================================================================
    ##                                       Dependent variable:        
    ##                                ----------------------------------
    ##                                 log_lm          log(index)       
    ##                                 robust             OLS           
    ##                                 linear                           
    ##                                   (1)              (2)           
    ## -----------------------------------------------------------------
    ## app_PTA                        0.618***          0.465**         
    ##                                 (0.211)          (0.234)         
    ##                                                                  
    ## app_GIM                         -0.098           -0.375*         
    ##                                 (0.212)          (0.220)         
    ##                                                                  
    ## log(obs_n)                     -0.688***        -0.540***        
    ##                                 (0.127)          (0.099)         
    ##                                                                  
    ## freq_Yearly                    -0.951***        -0.783***        
    ##                                 (0.295)          (0.279)         
    ##                                                                  
    ## count_n_america                0.499***          0.542***        
    ##                                 (0.185)          (0.188)         
    ##                                                                  
    ## count_europe                    -0.084            0.004          
    ##                                 (0.133)          (0.154)         
    ##                                                                  
    ## after_2005                       0.049            -0.080         
    ##                                 (0.224)          (0.244)         
    ##                                                                  
    ## type_Oligopsony                 -0.109*           -0.004         
    ##                                 (0.058)          (0.073)         
    ##                                                                  
    ## ind_meat                       0.601***          0.565***        
    ##                                 (0.193)          (0.169)         
    ##                                                                  
    ## ind_tobacco                      0.281            0.397*         
    ##                                 (0.193)          (0.207)         
    ##                                                                  
    ## ind_beverages                    0.119            0.170          
    ##                                 (0.152)          (0.166)         
    ##                                                                  
    ## ind_dairy                       0.485**          0.473***        
    ##                                 (0.189)          (0.163)         
    ##                                                                  
    ## ind_oils                        -0.348*           -0.147         
    ##                                 (0.187)          (0.175)         
    ##                                                                  
    ## ind_fruits                     0.595***          0.529***        
    ##                                 (0.190)          (0.173)         
    ##                                                                  
    ## ind_cereals                     -0.003            0.170          
    ##                                 (0.131)          (0.156)         
    ##                                                                  
    ## perish                         -0.588***        -0.450***        
    ##                                 (0.186)          (0.168)         
    ##                                                                  
    ## Constant                         0.205            -0.419         
    ##                                 (0.645)          (0.642)         
    ##                                                                  
    ## -----------------------------------------------------------------
    ## Observations                      459              459           
    ## R2                                                0.321          
    ## Adjusted R2                                       0.297          
    ## Residual Std. Error (df = 442)   0.538            0.667          
    ## F Statistic                              13.072*** (df = 16; 442)
    ## =================================================================
    ## Note:                                 *p<0.1; **p<0.05; ***p<0.01

## Weighted Least squares

``` r
wls <-  lm((index) ~ app_PTA + app_GIM 
               #+ poly(obs_n, 2)
               + log(obs_n) 
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals
               #+ perish
               #+ log(mean_pse) + log(mean_pp)
                 , 
         data = analysis,
         weights = weights)

summary(wls)
```

    ## 
    ## Call:
    ## lm(formula = (index) ~ app_PTA + app_GIM + log(obs_n) + freq_Yearly + 
    ##     count_n_america + count_europe + after_2005 + type_Oligopsony + 
    ##     ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils + 
    ##     ind_fruits + ind_cereals, data = analysis, weights = weights)
    ## 
    ## Weighted Residuals:
    ##       Min        1Q    Median        3Q       Max 
    ## -0.138847 -0.009669 -0.002667  0.003307  0.199263 
    ## 
    ## Coefficients:
    ##                  Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)      0.334545   0.040318   8.298 1.29e-15 ***
    ## app_PTA          0.132640   0.016192   8.192 2.78e-15 ***
    ## app_GIM          0.063504   0.017563   3.616 0.000334 ***
    ## log(obs_n)      -0.083620   0.007196 -11.620  < 2e-16 ***
    ## freq_Yearly     -0.067290   0.015093  -4.458 1.05e-05 ***
    ## count_n_america  0.070320   0.015200   4.626 4.90e-06 ***
    ## count_europe    -0.006697   0.014199  -0.472 0.637416    
    ## after_2005       0.090491   0.015302   5.914 6.69e-09 ***
    ## type_Oligopsony -0.002795   0.011723  -0.238 0.811703    
    ## ind_meat        -0.049957   0.016186  -3.086 0.002153 ** 
    ## ind_tobacco      0.066184   0.026773   2.472 0.013809 *  
    ## ind_beverages    0.016161   0.018952   0.853 0.394281    
    ## ind_dairy       -0.048930   0.014165  -3.454 0.000605 ***
    ## ind_oils        -0.042359   0.037373  -1.133 0.257650    
    ## ind_fruits      -0.078776   0.037974  -2.074 0.038613 *  
    ## ind_cereals     -0.041444   0.028359  -1.461 0.144623    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.0294 on 443 degrees of freedom
    ## Multiple R-squared:  0.4708, Adjusted R-squared:  0.4528 
    ## F-statistic: 26.27 on 15 and 443 DF,  p-value: < 2.2e-16

``` r
bptest(wls)
```

    ## 
    ##  studentized Breusch-Pagan test
    ## 
    ## data:  wls
    ## BP = 73.64, df = 15, p-value = 9.959e-10

``` r
plot(wls)
```

![](2.-Modeling_files/figure-gfm/unnamed-chunk-17-1.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-17-2.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-17-3.png)<!-- -->![](2.-Modeling_files/figure-gfm/unnamed-chunk-17-4.png)<!-- -->

``` r
model_1 <- lm(log(index) ~ app_PTA + app_GIM 
               + log(obs_n) 
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals, 
         data = analysis)
se_1 <- get_robust_se(model_1)

model_2 <- lm((index) ~ app_PTA + app_GIM 
               + log(obs_n) 
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals, 
         data = analysis, weights = weights)
se_2 <- get_robust_se(model_2)

model_3 <- lm(log(index) ~ app_PTA + app_GIM 
               + log(obs_n)
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals
               + perish
               #+ log(mean_pse) + log(mean_pp)
         ,data = analysis)
se_3 <- get_robust_se(model_3)


model_4 <- lm((index) ~ app_PTA + app_GIM 
               + log(obs_n) 
               + freq_Yearly 
               + count_n_america + count_europe 
               + after_2005 
               + type_Oligopsony 
               + ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils 
               + ind_fruits + ind_cereals
               + perish
               #+ log(mean_pse) + log(mean_pp)
         ,data = analysis, weights = weights)
se_4 <- get_robust_se(model_4)

stargazer(model_1, model_2, model_3, model_4, rlm,
          type = "text",
          keep.stat = c("n", "rsq", "adj.rsq"),
          title = "Analysis Results",
          column.labels =  c("OLS 1", "WLS 1", "OLS 2", "WLS 2"),
          #dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2, se_3, se_4),
          align = TRUE,
          intercept.bottom = FALSE
          #,out = "Tables/WLS.doc"
          )
```

    ## 
    ## Analysis Results
    ## ===================================================================
    ##                                 Dependent variable:                
    ##                 ---------------------------------------------------
    ##                 log(index)  (index)  log(index)  (index)   log_lm  
    ##                    OLS        OLS       OLS        OLS     robust  
    ##                                                            linear  
    ##                   OLS 1      WLS 1     OLS 2      WLS 2            
    ##                    (1)        (2)       (3)        (4)       (5)   
    ## -------------------------------------------------------------------
    ## Constant          -0.546   0.335***    -0.419   0.341***    0.205  
    ##                  (0.643)    (0.122)   (0.642)    (0.122)   (0.500) 
    ##                                                                    
    ## app_PTA          0.462**   0.133***   0.465**   0.133***  0.618*** 
    ##                  (0.235)    (0.033)   (0.234)    (0.033)   (0.170) 
    ##                                                                    
    ## app_GIM           -0.363     0.064    -0.375*    0.064*    -0.098  
    ##                  (0.222)    (0.040)   (0.220)    (0.039)   (0.161) 
    ##                                                                    
    ## log(obs_n)      -0.539***  -0.084*** -0.540***  -0.084*** -0.688***
    ##                  (0.099)    (0.027)   (0.099)    (0.027)   (0.084) 
    ##                                                                    
    ## freq_Yearly     -0.760***   -0.067   -0.783***   -0.069   -0.951***
    ##                  (0.279)    (0.053)   (0.279)    (0.053)   (0.214) 
    ##                                                                    
    ## count_n_america  0.607***   0.070**   0.542***   0.067*   0.499*** 
    ##                  (0.187)    (0.034)   (0.188)    (0.034)   (0.160) 
    ##                                                                    
    ## count_europe      0.007     -0.007     0.004     -0.007    -0.084  
    ##                  (0.155)    (0.023)   (0.154)    (0.023)   (0.136) 
    ##                                                                    
    ## after_2005        -0.067    0.090**    -0.080    0.089**    0.049  
    ##                  (0.245)    (0.043)   (0.244)    (0.043)   (0.173) 
    ##                                                                    
    ## type_Oligopsony   -0.008    -0.003     -0.004    -0.002    -0.109  
    ##                  (0.074)    (0.027)   (0.073)    (0.027)   (0.073) 
    ##                                                                    
    ## ind_meat          0.191     -0.050    0.565***    0.055   0.601*** 
    ##                  (0.127)    (0.036)   (0.169)    (0.038)   (0.177) 
    ##                                                                    
    ## ind_tobacco      0.443**     0.066     0.397*     0.064     0.281  
    ##                  (0.208)    (0.066)   (0.207)    (0.066)   (0.204) 
    ##                                                                    
    ## ind_beverages     0.222      0.016     0.170      0.012     0.119  
    ##                  (0.164)    (0.034)   (0.166)    (0.034)   (0.129) 
    ##                                                                    
    ## ind_dairy         0.145     -0.049    0.473***    0.052   0.485*** 
    ##                  (0.133)    (0.036)   (0.163)    (0.033)   (0.163) 
    ##                                                                    
    ## ind_oils          -0.100    -0.042     -0.147    -0.044   -0.348** 
    ##                  (0.171)    (0.040)   (0.175)    (0.040)   (0.150) 
    ##                                                                    
    ## ind_fruits        0.167    -0.079***  0.529***    0.019   0.595*** 
    ##                  (0.142)    (0.027)   (0.173)    (0.029)   (0.181) 
    ##                                                                    
    ## ind_cereals       0.247*    -0.041     0.170     -0.045    -0.003  
    ##                  (0.148)    (0.042)   (0.156)    (0.042)   (0.114) 
    ##                                                                    
    ## perish                               -0.450***  -0.107*** -0.588***
    ##                                       (0.168)    (0.033)   (0.165) 
    ##                                                                    
    ## -------------------------------------------------------------------
    ## Observations       459        459       459        459       459   
    ## R2                0.311      0.471     0.321      0.479            
    ## Adjusted R2       0.288      0.453     0.297      0.460            
    ## ===================================================================
    ## Note:                                   *p<0.1; **p<0.05; ***p<0.01

## Tobit model

``` r
library(censReg)
```

``` r
tobit <- censReg(index ~ app_PTA + app_GIM +
               #obs_n + I(obs_n^2) + I(obs_n^3) +
               log(obs_n) +
               freq_Yearly +
               count_n_america + count_europe +
               after_2005 +
               type_Oligopsony +
               ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
               ind_fruits + ind_cereals +
               perish +
               log(mean_pse) #+ log(mean_pp)
                 ,
                 data = analysis_full)
```

    ## Warning in log(mean_pse): NaNs produced

    ## Warning in censReg(index ~ app_PTA + app_GIM + log(obs_n) + freq_Yearly + : at
    ## least one value of the endogenous variable is smaller than the left limit

``` r
summary(tobit)
```

    ## 
    ## Call:
    ## censReg(formula = index ~ app_PTA + app_GIM + log(obs_n) + freq_Yearly + 
    ##     count_n_america + count_europe + after_2005 + type_Oligopsony + 
    ##     ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils + 
    ##     ind_fruits + ind_cereals + perish + log(mean_pse), data = analysis_full)
    ## 
    ## Observations:
    ##          Total  Left-censored     Uncensored Right-censored 
    ##            451              2            449              0 
    ## 
    ## Coefficients:
    ##                  Estimate Std. error t value  Pr(> t)    
    ## (Intercept)      0.226082   0.099942   2.262 0.023690 *  
    ## app_PTA          0.137970   0.028317   4.872 1.10e-06 ***
    ## app_GIM          0.054832   0.028590   1.918 0.055128 .  
    ## log(obs_n)      -0.111269   0.013770  -8.081 6.43e-16 ***
    ## freq_Yearly     -0.129507   0.033614  -3.853 0.000117 ***
    ## count_n_america  0.145127   0.029594   4.904 9.39e-07 ***
    ## count_europe    -0.018503   0.028778  -0.643 0.520263    
    ## after_2005       0.079073   0.030995   2.551 0.010736 *  
    ## type_Oligopsony  0.004152   0.011262   0.369 0.712366    
    ## ind_meat         0.068390   0.027518   2.485 0.012944 *  
    ## ind_tobacco      0.040311   0.032931   1.224 0.220917    
    ## ind_beverages    0.022733   0.020254   1.122 0.261692    
    ## ind_dairy        0.062389   0.025352   2.461 0.013859 *  
    ## ind_oils        -0.013025   0.022940  -0.568 0.570164    
    ## ind_fruits       0.062246   0.028064   2.218 0.026553 *  
    ## ind_cereals      0.010977   0.017382   0.632 0.527699    
    ## perish          -0.067896   0.025477  -2.665 0.007699 ** 
    ## log(mean_pse)    0.056728   0.020634   2.749 0.005973 ** 
    ## logSigma        -2.339524   0.033405 -70.034  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Newton-Raphson maximisation, 9 iterations
    ## Return code 1: gradient close to zero
    ## Log-likelihood: 410.9705 on 19 Df

``` r
model_1 <- lm(log(index) ~ app_PTA + app_GIM + type_Oligopoly, 
                        data = analysis)
se_1 <- get_robust_se(model_1)

model_2 <- lm(log(index) ~ app_PTA + app_GIM +
                type_Oligopoly +
                after_2005 + log(obs_n) +
                freq_Yearly +
                count_n_america + count_europe, 
         data = analysis)
se_2 <- get_robust_se(model_2)

model_3 <- lm(log(index) ~ app_PTA + app_GIM +
                type_Oligopoly +
                log(obs_n) + after_2005 +
                freq_Yearly +
                count_n_america + count_europe +
                ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
                ind_fruits + ind_cereals + perish,
         data = analysis)
se_3 <- get_robust_se(model_3)


model_4 <- lm(log(index) ~ app_PTA + app_GIM +
                type_Oligopoly +
                log(obs_n) + after_2005 +
                count_n_america + count_europe + freq_Yearly +
                ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
                ind_fruits + ind_cereals + perish +
                log(mean_pp) + log(mean_pse),
         data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_4 <- get_robust_se(model_4)

model_5 <- lm(log(index) ~ app_PTA + app_GIM +
                type_Oligopoly +
                log(obs_n) + after_2005 +
                count_n_america + count_europe + freq_Yearly +
                ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
                ind_fruits + ind_cereals + perish +
                log(mean_pp) + log(mean_pse) + 
                log(sfarm_share) + log(start_business),
         data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_5 <- get_robust_se(model_5)
```

## Summary tables

``` r
stargazer(model_1, model_2, model_3, model_4, model_5,
          type = "text",
          keep.stat = c("n", "rsq", "adj.rsq"),
          title = "Analysis Results",
          #column.labels =  c("Model 1", "Model 2", "Model 3"),
          dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2, se_3, se_4, se_5),
          align = TRUE,
          intercept.bottom = FALSE
          )
```

    ## 
    ## Analysis Results
    ## ====================================================================
    ##                                   Dependent variable:               
    ##                     ------------------------------------------------
    ##                           Market Power Index (log transformed)      
    ##                        (1)       (2)       (3)       (4)      (5)   
    ## --------------------------------------------------------------------
    ## Constant            -2.444***  -0.264    -0.423   -2.082**   26.346 
    ##                      (0.049)   (0.643)   (0.642)   (0.951)  (22.662)
    ##                                                                     
    ## app_PTA             0.595***   0.404*    0.465**   0.554**  1.846***
    ##                      (0.076)   (0.232)   (0.234)   (0.230)  (0.436) 
    ##                                                                     
    ## app_GIM             -0.534***  -0.391*   -0.375*    0.146    1.547* 
    ##                      (0.154)   (0.221)   (0.220)   (0.263)  (0.890) 
    ##                                                                     
    ## type_Oligopoly        0.086    -0.008     0.004    -0.021   0.155***
    ##                      (0.069)   (0.075)   (0.073)   (0.070)  (0.051) 
    ##                                                                     
    ## after_2005                     -0.130    -0.080     0.235    1.439  
    ##                                (0.237)   (0.244)   (0.266)  (1.720) 
    ##                                                                     
    ## log(obs_n)                    -0.546*** -0.540*** -0.696***  -0.309 
    ##                                (0.100)   (0.099)   (0.104)  (0.961) 
    ##                                                                     
    ## freq_Yearly                   -0.788*** -0.783*** -0.718***  1.112  
    ##                                (0.282)   (0.279)   (0.264)  (1.964) 
    ##                                                                     
    ## count_n_america               0.548***  0.542***  0.916***          
    ##                                (0.182)   (0.188)   (0.190)          
    ##                                                                     
    ## count_europe                    0.014     0.004    -0.082   -0.181**
    ##                                (0.157)   (0.154)   (0.128)  (0.089) 
    ##                                                                     
    ## ind_meat                                0.565***  0.560***  0.236***
    ##                                          (0.169)   (0.162)  (0.068) 
    ##                                                                     
    ## ind_tobacco                              0.397*     0.284           
    ##                                          (0.207)   (0.227)          
    ##                                                                     
    ## ind_beverages                             0.170     0.100           
    ##                                          (0.166)   (0.164)          
    ##                                                                     
    ## ind_dairy                               0.473***  0.464***   0.027  
    ##                                          (0.163)   (0.156)  (0.053) 
    ##                                                                     
    ## ind_oils                                 -0.147    -0.137           
    ##                                          (0.175)   (0.175)          
    ##                                                                     
    ## ind_fruits                              0.529***  0.533***  0.213***
    ##                                          (0.173)   (0.168)  (0.053) 
    ##                                                                     
    ## ind_cereals                               0.170     0.206           
    ##                                          (0.156)   (0.161)          
    ##                                                                     
    ## perish                                  -0.450*** -0.436***         
    ##                                          (0.168)   (0.162)          
    ##                                                                     
    ## log(mean_pp)                                        0.110    16.800 
    ##                                                    (0.353)  (16.535)
    ##                                                                     
    ## log(mean_pse)                                      0.522**  -10.711 
    ##                                                    (0.204)  (8.466) 
    ##                                                                     
    ## log(sfarm_share)                                             0.084  
    ##                                                             (0.052) 
    ##                                                                     
    ## log(start_business)                                          0.374  
    ##                                                             (0.269) 
    ##                                                                     
    ## --------------------------------------------------------------------
    ## Observations           459       459       459       439      194   
    ## R2                    0.224     0.295     0.321     0.353    0.303  
    ## Adjusted R2           0.219     0.282     0.297     0.325    0.248  
    ## ====================================================================
    ## Note:                                    *p<0.1; **p<0.05; ***p<0.01

``` r
model_1 <- lm(log(index) ~ app_PTA + app_GIM +
               log(obs_n) +
               freq_Yearly +
               count_n_america + count_europe +
               after_2005 +
               type_Oligopsony +
               ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
               ind_fruits + ind_cereals +
               perish +
               log(mean_pse)
                 ,
               data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_1 <- get_robust_se(model_1)

model_2 <- lm(log(index) ~ app_PTA + app_GIM +
               obs_n + I(obs_n^2) +
               freq_Yearly +
               count_n_america + count_europe +
               after_2005 +
               type_Oligopsony +
               ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
               ind_fruits + ind_cereals +
               perish +
               log(mean_pse)
                 ,
         data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_2 <- get_robust_se(model_2)



stargazer(model_1, model_2,
          type = "text",
          keep.stat = c("n", "rsq", "adj.rsq"),
          title = "Analysis Results",
          #column.labels =  c("Model 1", "Model 2", "Model 3"),
          dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2),
          align = TRUE,
          intercept.bottom = FALSE
          )
```

    ## 
    ## Analysis Results
    ## =====================================================
    ##                          Dependent variable:         
    ##                 -------------------------------------
    ##                 Market Power Index (log transformed) 
    ##                         (1)                (2)       
    ## -----------------------------------------------------
    ## Constant             -2.199**           -3.510***    
    ##                       (0.869)            (0.780)     
    ##                                                      
    ## app_PTA               0.559**           0.617***     
    ##                       (0.228)            (0.213)     
    ##                                                      
    ## app_GIM                0.158              0.226      
    ##                       (0.254)            (0.248)     
    ##                                                      
    ## log(obs_n)           -0.688***                       
    ##                       (0.100)                        
    ##                                                      
    ## obs_n                                   -0.031***    
    ##                                          (0.005)     
    ##                                                      
    ## I(obs_n2)                               0.0001***    
    ##                                         (0.00001)    
    ##                                                      
    ## freq_Yearly          -0.707***          -1.031***    
    ##                       (0.259)            (0.269)     
    ##                                                      
    ## count_n_america      0.892***           0.835***     
    ##                       (0.201)            (0.190)     
    ##                                                      
    ## count_europe          -0.098             -0.063      
    ##                       (0.141)            (0.130)     
    ##                                                      
    ## after_2005             0.238              0.346      
    ##                       (0.265)            (0.249)     
    ##                                                      
    ## type_Oligopsony        0.019              0.025      
    ##                       (0.069)            (0.068)     
    ##                                                      
    ## ind_meat             0.555***           0.568***     
    ##                       (0.160)            (0.166)     
    ##                                                      
    ## ind_tobacco            0.279              0.314      
    ##                       (0.224)            (0.218)     
    ##                                                      
    ## ind_beverages          0.096              0.086      
    ##                       (0.162)            (0.161)     
    ##                                                      
    ## ind_dairy            0.460***           0.469***     
    ##                       (0.154)            (0.157)     
    ##                                                      
    ## ind_oils              -0.142             -0.127      
    ##                       (0.173)            (0.173)     
    ##                                                      
    ## ind_fruits           0.528***           0.549***     
    ##                       (0.165)            (0.170)     
    ##                                                      
    ## ind_cereals            0.197              0.244      
    ##                       (0.153)            (0.152)     
    ##                                                      
    ## perish               -0.441***          -0.406**     
    ##                       (0.159)            (0.162)     
    ##                                                      
    ## log(mean_pse)        0.555***           0.613***     
    ##                       (0.172)            (0.161)     
    ##                                                      
    ## -----------------------------------------------------
    ## Observations            439                439       
    ## R2                     0.352              0.356      
    ## Adjusted R2            0.326              0.328      
    ## =====================================================
    ## Note:                     *p<0.1; **p<0.05; ***p<0.01

### Lets check if type there influence of industry on the MPI

``` r
industry <- matchCoefs(model_3, "ind") # extract all industry dummies
F_test_ind <-  linearHypothesis(model_3, industry, white.adjust = "hc1")
F_test_ind
```

    ## Linear hypothesis test
    ## 
    ## Hypothesis:
    ## ind_meat = 0
    ## ind_tobacco = 0
    ## ind_beverages = 0
    ## ind_dairy = 0
    ## ind_oils = 0
    ## ind_fruits = 0
    ## ind_cereals = 0
    ## 
    ## Model 1: restricted model
    ## Model 2: log(index) ~ app_PTA + app_GIM + type_Oligopoly + log(obs_n) + 
    ##     after_2005 + freq_Yearly + count_n_america + count_europe + 
    ##     ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils + 
    ##     ind_fruits + ind_cereals + perish
    ## 
    ## Note: Coefficient covariance matrix supplied.
    ## 
    ##   Res.Df Df      F  Pr(>F)  
    ## 1    449                    
    ## 2    442  7 2.4065 0.01998 *
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Therefore we reject 0 hypothesis that all types of industry have zero
coefficient.

### Determinants of each approach

Finally lets make a linear model for each approach and check if there is
any significant differences in coefficients between them

``` r
GIM <- lm(log(index) ~ type_Oligopoly +
                obs_n + after_2005 +
                freq_Yearly + freq_Quaterly +
                count_n_america + count_europe +
                ind_dairy + ind_meat + ind_beverages + ind_cereals + ind_oils,
         data = subset(analysis, app_GIM == 1)) 

PTA <- lm(log(index) ~ type_Oligopoly +
                obs_n + after_2005 + 
                freq_Yearly + freq_Quaterly +
                count_n_america + count_europe +
                ind_dairy + ind_meat + ind_beverages + ind_cereals + ind_oils, 
         data = subset(analysis, app_PTA == 1))

SFA <- lm(log(index) ~ type_Oligopoly +
                obs_n + after_2005 + 
                freq_Yearly + freq_Quaterly +
                count_n_america + count_europe +
                ind_dairy + ind_meat + ind_beverages + ind_cereals + ind_oils, 
         data = subset(analysis, app_SFA == 1)) 
```

``` r
bptest(SFA)
```

    ## 
    ##  studentized Breusch-Pagan test
    ## 
    ## data:  SFA
    ## BP = 39.194, df = 10, p-value = 2.348e-05

``` r
bptest(PTA)
```

    ## 
    ##  studentized Breusch-Pagan test
    ## 
    ## data:  PTA
    ## BP = 17.178, df = 12, p-value = 0.143

``` r
bptest(GIM)
```

    ## 
    ##  studentized Breusch-Pagan test
    ## 
    ## data:  GIM
    ## BP = 6.8178, df = 11, p-value = 0.8136

According to bptest there is no evidence of heteroscadasticity, so we
can use default SE

``` r
stargazer(GIM, PTA, SFA,
          type = "text",
          omit.stat = c("f", "ser"), 
          title = "Analysis Results",
          column.labels =  c("GIM", "PTA", "SFA"),
          dep.var.labels = "Market Power Index (log transformed)",
          align = TRUE,
          intercept.bottom = FALSE
          )
```

    ## 
    ## Analysis Results
    ## ======================================================
    ##                          Dependent variable:          
    ##                 --------------------------------------
    ##                  Market Power Index (log transformed) 
    ##                     GIM          PTA          SFA     
    ##                     (1)          (2)          (3)     
    ## ------------------------------------------------------
    ## Constant           -1.797     -2.731***     2.328***  
    ##                   (1.189)      (0.596)      (0.545)   
    ##                                                       
    ## type_Oligopoly     -0.350       -0.149       0.101*   
    ##                   (0.298)      (0.354)      (0.052)   
    ##                                                       
    ## obs_n              0.002        -0.005     -0.093***  
    ##                   (0.006)      (0.003)      (0.008)   
    ##                                                       
    ## after_2005       -1.805***     0.943**                
    ##                   (0.643)      (0.463)                
    ##                                                       
    ## freq_Yearly        -0.052       0.970      -3.779***  
    ##                   (0.883)      (0.728)      (0.500)   
    ##                                                       
    ## freq_Quaterly                   0.835                 
    ##                                (0.719)                
    ##                                                       
    ## count_n_america    0.037        0.214       1.487***  
    ##                   (0.685)      (0.616)      (0.206)   
    ##                                                       
    ## count_europe       0.330        -0.828       -0.057   
    ##                   (0.623)      (0.561)      (0.135)   
    ##                                                       
    ## ind_dairy          -0.325       0.221       -0.156**  
    ##                   (0.722)      (0.221)      (0.068)   
    ##                                                       
    ## ind_meat           0.429        0.089        0.097    
    ##                   (0.902)      (0.238)      (0.068)   
    ##                                                       
    ## ind_beverages      -0.531       0.375*       -0.154   
    ##                   (0.625)      (0.197)      (0.138)   
    ##                                                       
    ## ind_cereals       1.247***      0.305       -0.155**  
    ##                   (0.403)      (0.279)      (0.069)   
    ##                                                       
    ## ind_oils           0.008        0.244        -0.280   
    ##                   (0.595)      (0.226)      (0.179)   
    ##                                                       
    ## ------------------------------------------------------
    ## Observations         54          147          258     
    ## R2                 0.384        0.250        0.441    
    ## Adjusted R2        0.223        0.183        0.418    
    ## ======================================================
    ## Note:                      *p<0.1; **p<0.05; ***p<0.01

I think I am done with the analysis

# Summary Tables

I will work with dataset “clean” again

``` r
clean <- readRDS(here("data", "clean data", "Full_data.Rds"))
```

First of all lets create column with first author and year to uniquely
identify an article

``` r
clean <- clean %>%
  mutate(article_ref = str_c(
           str_match(authors, pattern = "^\\w[’]*\\w+" ),
           " (", year, ")")
         ) 

head(clean$article_ref, 20)
```

    ##  [1] "Anders (2008)"     "Anders (2008)"     "Anders (2008)"    
    ##  [4] "Anders (2008)"     "Appelbaum (1982)"  "Appelbaum (1982)" 
    ##  [7] "Azzam (1990)"      "Azzam (1990)"      "Bakucs (2009)"    
    ## [10] "Bakucs (2009)"     "Bergman (1995)"    "Bettendorf (2000)"
    ## [13] "Bhuyan (1997)"     "Bhuyan (1997)"     "Bhuyan (1997)"    
    ## [16] "Chidmi (2005)"     "Chirinko (1994)"   "Chirinko (1994)"  
    ## [19] "Genesove (1998)"   "Hockmann (2009)"

summary table of all articles used in analysis

``` r
#replace misspeled value
clean <- clean %>%
  mutate(data_freq = str_replace(data_freq, "Quaterly", "Quarterly")) 
```

### Table 1. List of studies

``` r
table_1 <- clean %>%
  group_by(article_ref, approach, mp_type, data_freq, period) %>%
  summarise(N = n()) %>%
  adorn_totals("row")
```

    ## `summarise()` regrouping output by 'article_ref', 'approach', 'mp_type', 'data_freq' (override with `.groups` argument)

``` r
head(table_1)
```

    ##       article_ref approach    mp_type data_freq    period N
    ##        Ahn (2010)      GIM  Oligopoly    Yearly 1975-2002 1
    ##     Anders (2008)      GIM Oligopsony   Monthly 1995-2000 2
    ##     Anders (2008)      GIM  Oligopoly   Monthly 1995-2000 2
    ##  Appelbaum (1982)      PTA  Oligopoly    Yearly 1947–1971 2
    ##      Azzam (1990)      PTA Oligopsony    Yearly 1959-1982 1
    ##      Azzam (1990)      PTA  Oligopoly    Yearly 1959-1982 1

``` r
table_1 %>%
  stargazer(type = output,
            style = "aer",
            title = "List of studies used",
            summary = FALSE, rownames = FALSE,
            out = "Tables/1.List of studies.doc"
            )
```

    ## 
    ## List of studies used
    ## ===============================================================
    ## article_ref         approach  mp_type   data_freq  period    N 
    ## ---------------------------------------------------------------
    ## Ahn (2010)            GIM    Oligopoly   Yearly   1975-2002  1 
    ## Anders (2008)         GIM    Oligopsony  Monthly  1995-2000  2 
    ## Anders (2008)         GIM    Oligopoly   Monthly  1995-2000  2 
    ## Appelbaum (1982)      PTA    Oligopoly   Yearly   1947–1971  2 
    ## Azzam (1990)          PTA    Oligopsony  Yearly   1959-1982  1 
    ## Azzam (1990)          PTA    Oligopoly   Yearly   1959-1982  1 
    ## Bakucs (2009)         PTA    Oligopsony  Monthly  1993-2003  1 
    ## Bakucs (2009)         PTA    Oligopsony  Monthly  1995-2004  1 
    ## Bergman (1995)        PTA    Oligopsony  Yearly   1960-1988  1 
    ## Bettendorf (2000)     GIM    Oligopoly   Monthly  1992-1996  1 
    ## Bhuyan (1997)         PTA    Oligopoly   Yearly   1972-1987  3 
    ## Bhuyan (1998)         PTA    Oligopoly   Yearly   1972-1987 38 
    ## Cechura (2015)        SFA    Oligopoly   Yearly   2003-2012 25 
    ## Chen (2018)           GIM    Oligopsony  Monthly  2008-2016  1 
    ## Chidmi (2005)         GIM    Oligopoly   Monthly  1996-2000  1 
    ## Chirinko (1994)       PTA    Oligopoly   Yearly   1973-1986  1 
    ## Chirinko (1994)       PTA    Oligopoly   Yearly   1973-1987  1 
    ## De (1999)             PTA    Oligopoly   Yearly   1962-1991  1 
    ## Genesove (1998)       GIM    Oligopoly   Yearly   1890-1914  1 
    ## Hockmann (2009)       PTA    Oligopsony  Monthly  1998-2006  1 
    ## Hovhannisyan (2012)   GIM    Oligopoly   Weekly   2001-2006  1 
    ## Ji (2016)             PTA    Oligopsony  Monthly  1980-2009  1 
    ## Kumbhakar (2012)      SFA    Oligopoly   Yearly   1974-1991  2 
    ## Lopez (1984)          PTA    Oligopoly   Yearly   1965-1979  1 
    ## Lopez (1993)          GIM    Oligopsony  Yearly   1954-1984  1 
    ## Lopez (2002)          PTA    Oligopoly   Yearly   1972-1997 25 
    ## Lopez (2017)          SFA    Oligopoly   Yearly   1990-2010 23 
    ## Lukas (2014)          SFA    Oligopsony  Yearly   2003-2012 94 
    ## Lukas (2014)          SFA    Oligopoly   Yearly   2003-2012 70 
    ## Mei (2008)            PTA    Oligopsony  Yearly   1955-2003  1 
    ## Mei (2008)            PTA    Oligopoly   Yearly   1955-2003  1 
    ## Merel (2009)          GIM    Oligopoly  Quarterly 1985-2005  1 
    ## Millan (1999)         PTA    Oligopoly   Yearly   1978-1992 14 
    ## Murray (1995)         PTA    Oligopsony  Yearly   1958-1988  1 
    ## Murray (1995)         PTA    Oligopsony  Yearly   1958-1989  1 
    ## Muth (1999)           GIM    Oligopsony  Yearly   1967-1993  1 
    ## O’Donnell (2007)      GIM    Oligopsony  Yearly   1989-2000 28 
    ## O’Donnell (2007)      GIM    Oligopoly   Yearly   1989-2000 12 
    ## Panagiotou (2015)     SFA    Oligopsony  Yearly   1970-2009  1 
    ## Panagiotou (2016)     SFA    Oligopsony  Yearly   1970-2009  2 
    ## Panagiotou (2018)     SFA    Oligopsony  Yearly   1970-2010  3 
    ## Perekhozhuk (2013)    PTA    Oligopsony  Yearly   1993-2006  1 
    ## Perekhozhuk (2013)    PTA    Oligopsony  Yearly   1993-2007  1 
    ## Perekhozhuk (2014)    PTA    Oligopsony  Monthly  1996-2003  1 
    ## Perekhozhuk (2016)    GIM    Oligopsony  Monthly  1996-2003  1 
    ## Perekhozhuk (2016)    PTA    Oligopsony  Monthly  1996-2003  8 
    ## Rigoberto (2015)      SFA    Oligopoly   Yearly   1979-2009 36 
    ## Salhofer (2011)       GIM    Oligopsony  Monthly  1997-2008  1 
    ## Salhofer (2011)       GIM    Oligopoly   Monthly  1997-2008  1 
    ## Sanjib (1997)         PTA    Oligopoly   Yearly   1972-1987 37 
    ## Scalco (2014)         GIM    Oligopsony  Yearly   1997-2011  1 
    ## Scalco (2016)         SFA    Oligopsony  Monthly  2010-2015  1 
    ## Scalco (2016)         SFA    Oligopoly   Monthly  2010-2015  1 
    ## Silva (2019)          PTA    Oligopsony Quarterly 2016-2017  2 
    ## Stalgiene (2017)      PTA    Oligopsony Quarterly 2004-2014  3 
    ## Suzuki (1993)         GIM    Oligopoly   Yearly   1979-1989  1 
    ## Weerahewa (2003)      GIM    Oligopsony  Yearly   1970-2000  3 
    ## Weerahewa (2003)      GIM    Oligopoly   Yearly   1970-2000  3 
    ## Total                  -         -          -         -     472
    ## ---------------------------------------------------------------

### Table 2. Number of observations by country

``` r
table_2 <-  clean %>%
  mutate(country = as_factor(country) %>%
           fct_infreq() %>%
           fct_lump_min(min = 10) 
         ) %>%
  group_by(country) %>%
  summarise(n = n(), 
            mean_mp = round(mean(mp_index), 4)
            ) %>%
  ungroup() %>%
  mutate(prop = round(n / sum(n) * 100, 2) ) %>%
  select(country, n, prop, mean_mp) %>%
  adorn_totals("row")
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

``` r
table_2 %>%
  stargazer(type = output,
            style = "aer",
            title = "Summary of MP observations by country",
            summary = FALSE, rownames = FALSE,
            out = "Tables/2.List of countries.doc")
```

    ## 
    ## Summary of MP observations by country
    ## ===============================
    ## country        n  prop  mean_mp
    ## -------------------------------
    ## United States 186 39.41 0.1968 
    ## Australia     40  8.47  0.0703 
    ## Spain         22  4.66  0.0879 
    ## Germany       13  2.75  0.0942 
    ## Hungary       12  2.54  0.1224 
    ## Ukraine       10  2.12  0.1378 
    ## Other         189 40.04 0.1007 
    ## Total         472 99.99 0.8101 
    ## -------------------------------

Visualize the distribution

``` r
clean %>%
    mutate(country = as_factor(country) %>%
           fct_infreq() %>%
           fct_lump_min(min = 10) 
         ) %>%
  ggplot(aes(x = country,
             y = mp_index,
             color = approach)) + 
  geom_jitter(width = 0.25, height = 0, alpha = 0.6, size = 2) +
  theme_minimal() +
  easy_legend_at("bottom") +
  easy_remove_x_axis("title") +
  labs(y = "Market Power Index",
       title = "The distribution of MP indices by country",
       caption = "Source: own representation",
       color = "Approach:") 
```

![](2.-Modeling_files/figure-gfm/unnamed-chunk-37-1.png)<!-- -->

### Table 3 Number of observations by sector

``` r
table_3 <- clean %>%
  mutate(industry_fct = fct_infreq(industry_fct) %>%
           fct_relevel("other", after = Inf)
         ) %>%
  group_by(industry_fct) %>%
  summarise(n = n(), 
            mean_mp = round(mean(mp_index), 4)
            ) %>%
  ungroup() %>%
  mutate(prop = round(n / sum(n) * 100, 2),
         industry_fct = str_to_title(industry_fct)) %>%
  select(industry_fct, n, prop, mean_mp) %>%
  adorn_totals("row")
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

Save table

``` r
table_3 %>%
  stargazer(type = output,
            style = "aer",
            title = "Summary of MP observations by sector",
            summary = FALSE, rownames = FALSE,
            out = "Tables/3. List of industries.doc")
```

    ## 
    ## Summary of MP observations by sector
    ## ==============================
    ## industry_fct  n  prop  mean_mp
    ## ------------------------------
    ## Dairy        92  19.49 0.1177 
    ## Cereals      86  18.22 0.1185 
    ## Meat         78  16.53 0.1129 
    ## Fruits       56  11.86 0.1089 
    ## Beverages    38  8.05  0.1736 
    ## Oils         23  4.87  0.1583 
    ## Tobacco      11  2.33  0.2942 
    ## Other        88  18.64 0.1712 
    ## Total        472 99.99 1.2553 
    ## ------------------------------

Visualize the distribution

``` r
clean %>%
  ggplot(aes(x = fct_reorder(industry_fct, mp_index, median) %>%
               str_to_sentence(),
             y = mp_index,
             color = approach)) + 
  geom_jitter(width = 0.25, height = 0, alpha = 0.6, size = 2) +
  theme_minimal() +
  easy_legend_at("bottom") +
  easy_remove_x_axis("title") +
  labs(y = "Market Power Index",
       title = "The distribution of MP indices by sector",
       caption = "Source: own representation",
       color = "Approach:") 
```

![](2.-Modeling_files/figure-gfm/unnamed-chunk-41-1.png)<!-- --> Save
plot

### Table 4: Number of observations by methodology

``` r
table_4 <- clean %>%
  group_by(approach) %>%
  summarise(n = n(), 
            mean_mp = round(mean(mp_index), 4)
            ) %>%
  ungroup() %>%
  mutate(prop = round(n / sum(n) * 100, 2)) %>%
  select(approach, n, prop, mean_mp) %>%
  adorn_totals("row")
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

``` r
table_4 %>%
  stargazer(type = output,
            style = "aer",
            title = "Summary of MP observations by approach used",
            summary = FALSE, rownames = FALSE,
            out = "Tables/4. List of Methods.doc")
```

    ## 
    ## Summary of MP observations by approach used
    ## ==========================
    ## approach  n  prop  mean_mp
    ## --------------------------
    ## GIM      64  13.56 0.0736 
    ## PTA      150 31.78 0.2213 
    ## SFA      258 54.66 0.1029 
    ## Total    472  100  0.3978 
    ## --------------------------

### Table 5: List of observarion frequency

``` r
table_5 <- clean %>%
  group_by(data_freq) %>%
  summarise(n = n(), 
            mean_mp = round(mean(mp_index), 4)
            ) %>%
  ungroup() %>%
  mutate(prop = round(n / sum(n) * 100, 2)) %>%
  select(data_freq, n, prop, mean_mp) %>%
  arrange(-n) %>%
  adorn_totals("row")
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

``` r
table_5 %>%
  stargazer(type = output,
            style = "aer",
            title = "Summary of MP observations by frequency",
            summary = FALSE, rownames = FALSE,
            out = "Tables/5. List of observarion frequency.doc")
```

    ## 
    ## Summary of MP observations by frequency
    ## ===========================
    ## data_freq  n  prop  mean_mp
    ## ---------------------------
    ## Yearly    440 93.22 0.1374 
    ## Monthly   25   5.3  0.0952 
    ## Quarterly  6  1.27  0.2667 
    ## Weekly     1  0.21   0.022 
    ## Total     472  100  0.5213 
    ## ---------------------------

### Table 6: Discriptive statistics of variables

``` r
analysis %>%
  as.data.frame() %>%
  stargazer(type = output,
            style = "aer",
            align = TRUE, nobs = FALSE,
            out = "Tables/6. Descriprive stat.doc")
```

    ## 
    ## ==================================================================
    ## Statistic           Mean  St. Dev.  Min   Pctl(25) Pctl(75)  Max  
    ## ------------------------------------------------------------------
    ## index              0.140   0.121   0.007   0.064    0.179   0.815 
    ## obs_n              19.874  25.987    4       9        20     348  
    ## after_2005         0.706   0.456     0       0        1       1   
    ## perish             0.484   0.500     0       0        1       1   
    ## mean_pse           21.639  8.604   -1.024  16.293   25.496  70.144
    ## mean_pp            1.152   0.239   0.920   1.088    1.136   3.917 
    ## sfarm_share        37.558  20.126  11.955  18.401   51.061  79.828
    ## sfarm_share_by_cat 33.838  26.533  0.734   7.286    55.176  94.212
    ## start_business     83.516  11.034  24.091  77.502   91.209  96.235
    ## edb_index          76.389  8.262   55.010  69.439   86.280  91.015
    ## weights            0.094   0.213   0.006   0.006    0.040   1.000 
    ## freq_Monthly       0.052   0.223     0       0        0       1   
    ## freq_Yearly        0.935   0.247     0       1        1       1   
    ## freq_Quaterly      0.011   0.104     0       0        0       1   
    ## freq_Weekly        0.002   0.047     0       0        0       1   
    ## type_Oligopsony    0.349   0.477     0       0        1       1   
    ## type_Oligopoly     0.651   0.477     0       0        1       1   
    ## ind_meat           0.166   0.372     0       0        0       1   
    ## ind_tobacco        0.024   0.153     0       0        0       1   
    ## ind_beverages      0.081   0.273     0       0        0       1   
    ## ind_dairy          0.198   0.399     0       0        0       1   
    ## ind_oils           0.048   0.214     0       0        0       1   
    ## ind_fruits         0.122   0.328     0       0        0       1   
    ## ind_cereals        0.176   0.382     0       0        0       1   
    ## ind_other          0.185   0.389     0       0        0       1   
    ## count_europe       0.460   0.499     0       0        1       1   
    ## count_n_america    0.407   0.492     0       0        1       1   
    ## count_other        0.133   0.340     0       0        0       1   
    ## app_GIM            0.118   0.323     0       0        0       1   
    ## app_PTA            0.320   0.467     0       0        1       1   
    ## app_SFA            0.562   0.497     0       0        1       1   
    ## ------------------------------------------------------------------

### Table 7: Regression table

``` r
model_1 <- lm(log(index) ~ app_PTA + app_GIM +
               after_2005 + type_Oligopsony, 
         data = analysis)
se_1 <- get_robust_se(model_1)

model_2 <- lm(log(index) ~ app_PTA + app_GIM +
               after_2005 + type_Oligopsony +
               log(obs_n) +
               freq_Yearly +
               count_n_america + count_europe, 
         data = analysis)
se_2 <- get_robust_se(model_2)


model_3 <- lm(log(index) ~ app_PTA + app_GIM +
               after_2005 + type_Oligopsony +
               log(obs_n) +
               freq_Yearly +
               count_n_america + count_europe +
               ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
               ind_fruits + ind_cereals, 
         data = analysis)
se_3 <- get_robust_se(model_3)

model_4 <- lm(log(index) ~ app_PTA + app_GIM +
                after_2005 + type_Oligopsony +
                log(obs_n) +
                freq_Yearly +
                count_n_america + count_europe +
                ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
                ind_fruits + ind_cereals + perish +
                log(mean_pp) + log(mean_pse),
         data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_4 <- get_robust_se(model_4)

model_5 <- lm(log(index) ~ app_PTA + app_GIM +
                after_2005 + type_Oligopsony +
                log(obs_n) +
                freq_Yearly +
                count_n_america + 
                ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
                ind_fruits + ind_cereals + perish +
                log(mean_pp) + log(mean_pse) +
                log(sfarm_share) + log(start_business),
         data = analysis)
```

    ## Warning in log(mean_pse): NaNs produced

``` r
se_5 <- get_robust_se(model_5)

ind.var.names <- c("Intercept", "PTA", "GIM", "After 2005", "Oligopsony",
                   "Obs. Num. (log)", "Yearly", "USA", "Europe",
                   "Meat", "Tobacco", "Beverages", "Dairy", "Oils", "Fruits",
                   "Cereals", "Perishable", "PP (log)",
                   "PSE (log)", "Small Farm Share (log)",
                   "Start Business Ease (log)")

stargazer(model_1, model_2, model_3, model_4, model_5,
          type = output,
          style = "io",
          omit.stat = c("rsq"), 
          title = "Regression Results",
          dep.var.labels = "Market Power Index (log)",
          covariate.labels = ind.var.names,
          se = list(se_1, se_2, se_3, se_4, se_5),      #  Robust se
          align = TRUE,
          df = FALSE,
          intercept.bottom = FALSE,
          out = "Tables/7. Regression Table.doc"
          )
```

    ## 
    ## Regression Results
    ## ---------------------------------------------------------------------------
    ##                                       Market Power Index (log)             
    ##                              (1)       (2)       (3)       (4)       (5)   
    ## ---------------------------------------------------------------------------
    ## Intercept                 -2.078***  -0.272    -0.546   -2.104**   26.620  
    ##                            (0.159)   (0.642)   (0.643)   (0.946)  (22.575) 
    ## PTA                        0.350**   0.404*    0.462**   0.554**  1.862*** 
    ##                            (0.152)   (0.232)   (0.235)   (0.230)   (0.435) 
    ## GIM                       -0.606***  -0.391*   -0.363     0.146    1.574*  
    ##                            (0.163)   (0.221)   (0.222)   (0.263)   (0.889) 
    ## After 2005                 -0.305*   -0.130    -0.067     0.235     1.372  
    ##                            (0.163)   (0.237)   (0.245)   (0.266)   (1.713) 
    ## Oligopsony                 -0.023     0.008    -0.008     0.021   -0.155***
    ##                            (0.072)   (0.075)   (0.074)   (0.070)   (0.052) 
    ## Obs. Num. (log)                     -0.546*** -0.539*** -0.696***  -0.296  
    ##                                      (0.100)   (0.099)   (0.104)   (0.961) 
    ## Yearly                              -0.788*** -0.760*** -0.718***   1.146  
    ##                                      (0.282)   (0.279)   (0.264)   (1.963) 
    ## USA                                 0.548***  0.607***  0.916***           
    ##                                      (0.182)   (0.187)   (0.190)           
    ## Europe                                0.014     0.007    -0.082            
    ##                                      (0.157)   (0.155)   (0.128)           
    ## Meat                                            0.191   0.560***  0.236*** 
    ##                                                (0.127)   (0.162)   (0.068) 
    ## Tobacco                                        0.443**    0.284            
    ##                                                (0.208)   (0.227)           
    ## Beverages                                       0.222     0.100            
    ##                                                (0.164)   (0.164)           
    ## Dairy                                           0.145   0.464***    0.027  
    ##                                                (0.133)   (0.156)   (0.054) 
    ## Oils                                           -0.100    -0.137            
    ##                                                (0.171)   (0.175)           
    ## Fruits                                          0.167   0.533***  0.214*** 
    ##                                                (0.142)   (0.168)   (0.054) 
    ## Cereals                                        0.247*     0.206            
    ##                                                (0.148)   (0.161)           
    ## Perishable                                              -0.436***          
    ##                                                          (0.162)           
    ## PP (log)                                                  0.110    16.093  
    ##                                                          (0.353)  (16.464) 
    ## PSE (log)                                                0.522**   -10.497 
    ##                                                          (0.204)   (8.429) 
    ## Small Farm Share (log)                                              0.048  
    ##                                                                    (0.045) 
    ## Start Business Ease (log)                                           0.199  
    ##                                                                    (0.241) 
    ## Observations                 459       459       459       439       194   
    ## Adjusted R-squared          0.224     0.282     0.288     0.325     0.247  
    ## Residual standard error     0.700     0.673     0.671     0.651     0.376  
    ## F statistic               34.134*** 23.535*** 13.346*** 12.708*** 5.861*** 
    ## ---------------------------------------------------------------------------
    ## Notes:                    ***p < .01; **p < .05; *p < .1

### Table 8: Methods comparison

``` r
stargazer(PTA, GIM, SFA,
          type = output,
          style = "aer",
          #omit.stat=c("f", "ser", "n"), 
          title = "Methods Comparison",
          dep.var.labels = "Market Power Index",
          column.labels =  c("PTA", "GIM", "SFA"),
          covariate.labels = ind.var.names,
          align = TRUE,
          df = FALSE,
          intercept.bottom = FALSE,
          out = "Tables/8. Method Comparison.doc"
          )
```

    ## 
    ## Methods Comparison
    ## ============================================================
    ##                                Market Power Index           
    ##                          PTA           GIM          SFA     
    ##                          (1)           (2)          (3)     
    ## ------------------------------------------------------------
    ## Intercept             -2.731***      -1.797       2.328***  
    ##                        (0.596)       (1.189)      (0.545)   
    ##                                                             
    ## PTA                    -0.149        -0.350        0.101*   
    ##                        (0.354)       (0.298)      (0.052)   
    ##                                                             
    ## GIM                    -0.005         0.002      -0.093***  
    ##                        (0.003)       (0.006)      (0.008)   
    ##                                                             
    ## After 2005             0.943**      -1.805***               
    ##                        (0.463)       (0.643)                
    ##                                                             
    ## Oligopsony              0.970        -0.052      -3.779***  
    ##                        (0.728)       (0.883)      (0.500)   
    ##                                                             
    ## Obs. Num. (log)         0.835                               
    ##                        (0.719)                              
    ##                                                             
    ## Yearly                  0.214         0.037       1.487***  
    ##                        (0.616)       (0.685)      (0.206)   
    ##                                                             
    ## USA                    -0.828         0.330        -0.057   
    ##                        (0.561)       (0.623)      (0.135)   
    ##                                                             
    ## Europe                  0.221        -0.325       -0.156**  
    ##                        (0.221)       (0.722)      (0.068)   
    ##                                                             
    ## Meat                    0.089         0.429        0.097    
    ##                        (0.238)       (0.902)      (0.068)   
    ##                                                             
    ## Tobacco                0.375*        -0.531        -0.154   
    ##                        (0.197)       (0.625)      (0.138)   
    ##                                                             
    ## Beverages               0.305       1.247***      -0.155**  
    ##                        (0.279)       (0.403)      (0.069)   
    ##                                                             
    ## Dairy                   0.244         0.008        -0.280   
    ##                        (0.226)       (0.595)      (0.179)   
    ##                                                             
    ## Observations             147           54           258     
    ## R2                      0.250         0.384        0.441    
    ## Adjusted R2             0.183         0.223        0.418    
    ## Residual Std. Error     0.743         0.974        0.374    
    ## F Statistic           3.726***       2.384**     19.493***  
    ## ------------------------------------------------------------
    ## Notes:              ***Significant at the 1 percent level.  
    ##                     **Significant at the 5 percent level.   
    ##                     *Significant at the 10 percent level.

``` r
clean %>%
  ggplot(aes(x = n_of_obs, y = mp_index, color = approach)) +
  geom_point(size = 4, alpha = 0.8, shape = 1) +
  scale_x_continuous(trans = "log10") +
  theme_minimal() +
  easy_move_legend(to = "bottom") +
    labs(x = "Number of observations (log10)",
         y = "Market Power Index",
         title = "Relationship between MP index and number of observations \nused in a study",
         caption = "Source: own representation") +
  easy_add_legend_title("Approach used:")
```

![](2.-Modeling_files/figure-gfm/unnamed-chunk-50-1.png)<!-- -->

### Tables PP and PSE

``` r
stargazer(model_1, model_2, model_3, model_4, model_5, model_6,
          type = output,
          style = "aer",
          #title = "Regressions Results",
          keep.stat = c("n", "rsq", "adj.rsq"), 
          title = "Analysis Results",
          #column.labels =  c("Model 1", "Model 2", "Model 3"),
          dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2, se_3, se_4, se_5, se_6),
          align = TRUE,
          intercept.bottom = FALSE,
          out = "Tables/9. PP vs PSE.doc"
          )
```

    ## 
    ## Analysis Results
    ## ===========================================================================
    ##                            Market Power Index (log transformed)            
    ##                    (1)       (2)       (3)       (4)       (5)       (6)   
    ## ---------------------------------------------------------------------------
    ## Constant        -3.749*** -2.448*** -4.104*** -2.625*** -2.601*** -2.555***
    ##                  (0.450)   (0.092)   (0.543)   (0.162)   (0.203)   (0.183) 
    ##                                                                            
    ## app_PTA         0.478***  0.598***  0.493***  0.591***  0.599***  0.592*** 
    ##                  (0.103)   (0.094)   (0.102)   (0.095)   (0.095)   (0.095) 
    ##                                                                            
    ## app_GIM          -0.044   -0.434***   0.066   -0.356**  -0.437***  -0.328* 
    ##                  (0.177)   (0.160)   (0.201)   (0.162)   (0.160)   (0.169) 
    ##                                                                            
    ## type_Oligopoly   -0.059    -0.042    -0.044    -0.060    -0.045    -0.058  
    ##                  (0.073)   (0.074)   (0.073)   (0.074)   (0.074)   (0.074) 
    ##                                                                            
    ## obs_n           -0.007*** -0.006*** -0.007*** -0.006*** -0.006*** -0.006***
    ##                  (0.002)   (0.001)   (0.002)   (0.001)   (0.001)   (0.001) 
    ##                                                                            
    ## count_n_america 0.501***  0.286***  0.487***  0.337***  0.290***  0.341*** 
    ##                  (0.124)   (0.106)   (0.122)   (0.112)   (0.105)   (0.113) 
    ##                                                                            
    ## ind_dairy         0.043     0.060     0.027     0.071     0.063     0.068  
    ##                  (0.089)   (0.093)   (0.088)   (0.092)   (0.093)   (0.091) 
    ##                                                                            
    ## ind_meat          0.089     0.102     0.069     0.092     0.107     0.083  
    ##                  (0.088)   (0.091)   (0.087)   (0.090)   (0.092)   (0.089) 
    ##                                                                            
    ## ind_beverages    -0.013     0.046    -0.016     0.038     0.049     0.034  
    ##                  (0.146)   (0.150)   (0.145)   (0.147)   (0.150)   (0.147) 
    ##                                                                            
    ## ind_cereals      0.199*    0.174*    0.181*    0.186*    0.178*    0.182*  
    ##                  (0.104)   (0.105)   (0.104)   (0.105)   (0.105)   (0.104) 
    ##                                                                            
    ## ind_oils         -0.206    -0.217    -0.210    -0.210    -0.214    -0.211  
    ##                  (0.159)   (0.162)   (0.157)   (0.160)   (0.162)   (0.160) 
    ##                                                                            
    ## log(mean_pse)   0.419***            0.557***                               
    ##                  (0.137)             (0.174)                               
    ##                                                                            
    ## log(mean_pp)                0.204    -0.561                                
    ##                            (0.338)   (0.373)                               
    ##                                                                            
    ## mean_pse                                        0.008               0.011  
    ##                                                (0.006)             (0.008) 
    ##                                                                            
    ## mean_pp                                                   0.155    -0.119  
    ##                                                          (0.157)   (0.196) 
    ##                                                                            
    ## Observations       439       450       439       450       450       450   
    ## R2                0.291     0.274     0.295     0.279     0.275     0.280  
    ## Adjusted R2       0.273     0.256     0.275     0.261     0.257     0.260  
    ## ---------------------------------------------------------------------------
    ## Notes:          ***Significant at the 1 percent level.                     
    ##                 **Significant at the 5 percent level.                      
    ##                 *Significant at the 10 percent level.

### tables small farm and perish

``` r
stargazer(model_1, model_2, model_3, model_4,
          type = output,
          style = "aer",
          #title = "Regressions Results",
          keep.stat = c("n", "rsq", "adj.rsq"), 
          title = "Analysis Results",
          #column.labels =  c("Model 1", "Model 2", "Model 3"),
          dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2, se_3),
          align = TRUE,
          intercept.bottom = FALSE,
          out = "Tables/10. Small farm and perish.doc"
          )
```

    ## 
    ## Analysis Results
    ## =================================================================
    ##                           Market Power Index (log transformed)   
    ##                            (1)        (2)        (3)       (4)   
    ## -----------------------------------------------------------------
    ## Constant                -3.698***  -3.559***  -2.431*** -2.288***
    ##                          (0.470)    (0.430)    (0.157)   (0.126) 
    ##                                                                  
    ## app_PTA                  0.473***   0.444***  1.020***  1.013*** 
    ##                          (0.103)    (0.104)    (0.290)   (0.199) 
    ##                                                                  
    ## app_GIM                   -0.059     -0.097     0.420     0.401  
    ##                          (0.178)    (0.173)    (0.688)   (0.280) 
    ##                                                                  
    ## type_Oligopoly            -0.061     -0.077   0.163***  0.165*** 
    ##                          (0.074)    (0.075)    (0.050)   (0.055) 
    ##                                                                  
    ## obs_n                   -0.007***  -0.007***  -0.015**  -0.014***
    ##                          (0.002)    (0.002)    (0.006)   (0.003) 
    ##                                                                  
    ## count_n_america          0.474***   0.412***                     
    ##                          (0.135)    (0.118)                      
    ##                                                                  
    ## ind_dairy                 0.067               -0.168**   -0.141  
    ##                          (0.091)               (0.068)   (0.087) 
    ##                                                                  
    ## ind_meat                  0.121                 0.002     0.019  
    ##                          (0.092)               (0.079)   (0.082) 
    ##                                                                  
    ## ind_beverages             -0.038                0.125            
    ##                          (0.156)               (0.601)           
    ##                                                                  
    ## ind_cereals               0.158               -0.210***  -0.178* 
    ##                          (0.147)               (0.054)   (0.093) 
    ##                                                                  
    ## ind_oils                  -0.230                                 
    ##                          (0.171)                                 
    ##                                                                  
    ## log(mean_pse)            0.419***   0.403***                     
    ##                          (0.136)    (0.132)                      
    ##                                                                  
    ## perish                    -0.074     -0.075                      
    ##                          (0.132)    (0.067)                      
    ##                                                                  
    ## log(sfarm_share)                               0.063*            
    ##                                                (0.037)           
    ##                                                                  
    ## log(sfarm_share_by_cat)                                   0.018  
    ##                                                          (0.026) 
    ##                                                                  
    ## Observations               439        439        203       201   
    ## R2                        0.292      0.281      0.271     0.263  
    ## Adjusted R2               0.272      0.269      0.237     0.233  
    ## -----------------------------------------------------------------
    ## Notes:                  ***Significant at the 1 percent level.   
    ##                         **Significant at the 5 percent level.    
    ##                         *Significant at the 10 percent level.

### tables doing business

``` r
stargazer(model_1, model_2, model_3,
          type = output,
          style = "aer",
          #title = "Regressions Results",
          keep.stat = c("n", "rsq", "adj.rsq"), 
          title = "Analysis Results",
          #column.labels =  c("Model 1", "Model 2", "Model 3"),
          dep.var.labels = "Market Power Index (log transformed)",
          se = list(se_1, se_2, se_3),
          align = TRUE,
          intercept.bottom = FALSE,
          out = "Tables/11. DB.doc"
          )
```

    ## 
    ## Analysis Results
    ## ============================================================
    ##                       Market Power Index (log transformed)  
    ##                          (1)           (2)          (3)     
    ## ------------------------------------------------------------
    ## Constant              -3.749***     -4.050***     -2.153*   
    ##                        (0.450)       (0.652)      (1.260)   
    ##                                                             
    ## app_PTA               0.478***      1.047***      1.035***  
    ##                        (0.103)       (0.200)      (0.173)   
    ##                                                             
    ## app_GIM                -0.044         0.097       -0.361**  
    ##                        (0.177)       (0.218)      (0.180)   
    ##                                                             
    ## type_Oligopoly         -0.059         0.020        0.051    
    ##                        (0.073)       (0.071)      (0.076)   
    ##                                                             
    ## obs_n                 -0.007***     -0.009***    -0.007***  
    ##                        (0.002)       (0.002)      (0.002)   
    ##                                                             
    ## count_n_america       0.501***      0.467***       0.203    
    ##                        (0.124)       (0.151)      (0.133)   
    ##                                                             
    ## ind_dairy               0.043        -0.080        -0.096   
    ##                        (0.089)       (0.094)      (0.101)   
    ##                                                             
    ## ind_meat                0.089         0.012        0.044    
    ##                        (0.088)       (0.097)      (0.102)   
    ##                                                             
    ## ind_beverages          -0.013        -0.272        -0.074   
    ##                        (0.146)       (0.228)      (0.251)   
    ##                                                             
    ## ind_cereals            0.199*         0.102        0.061    
    ##                        (0.104)       (0.105)      (0.110)   
    ##                                                             
    ## ind_oils               -0.206       -0.674***    -0.735***  
    ##                        (0.159)       (0.138)      (0.146)   
    ##                                                             
    ## log(mean_pse)         0.419***      0.508***                
    ##                        (0.137)       (0.167)                
    ##                                                             
    ## start_business                        0.001                 
    ##                                      (0.004)                
    ##                                                             
    ## log(start_business)                                -0.049   
    ##                                                   (0.286)   
    ##                                                             
    ## Observations             439           307          319     
    ## R2                      0.291         0.264        0.233    
    ## Adjusted R2             0.273         0.234        0.206    
    ## ------------------------------------------------------------
    ## Notes:              ***Significant at the 1 percent level.  
    ##                     **Significant at the 5 percent level.   
    ##                     *Significant at the 10 percent level.

## Table conference Rajske Teplice

``` r
model_1 <- lm(log(index) ~ app_PTA + app_GIM +
               after_2005 + type_Oligopsony, 
         data = analysis)
se_1 <- get_robust_se(model_1)

model_2 <- lm(update(formula(model_1), ~ . +
                       log(obs_n) + freq_Yearly +
                       count_n_america + count_europe),

         data = analysis)
se_2 <- get_robust_se(model_2)


model_3 <- lm(update(formula(model_2), ~ . +
               ind_meat + ind_tobacco + ind_beverages + ind_dairy + ind_oils +
               ind_fruits + ind_cereals), 
         data = analysis)
se_3 <- get_robust_se(model_3)


model_4 <- lm(update(formula(model_3), ~ . +
                       perish),
                       data = analysis)
se_4 <- get_robust_se(model_4)

model_5 <- MASS::rlm(formula(model_4),
                     data = analysis,
                     maxit = 100,
                     psi = "psi.bisquare")
se_5 <- get_robust_se(model_5)

ind.var.names <- c("Intercept", "PTA", "GIM", "After 2005", "Oligopsony",
                   "Obs. Num. (log)", "Yearly", "USA", "Europe",
                   "Meat", "Tobacco", "Beverages", "Dairy", "Oils", "Fruits",
                   "Cereals", "Perishable")

stargazer(model_1, model_2, model_3, model_4, model_5,
          type = output,
          style = "io",
          title = "Regression Results",
          dep.var.labels = "Market Power Index (log)",
          covariate.labels = ind.var.names,
          dep.var.labels.include = FALSE,
          omit.stat = c("adj.rsq", "n"),
          se = list(se_1, se_2, se_3, se_4, se_5),      #  Robust se
          align = TRUE,
          df = FALSE,
          intercept.bottom = FALSE,
          star.cutoffs = c(0.05, 0.01, 0.001),
          out = "Tables/Regression Table Teplice.doc"
          )
```

    ## 
    ## Regression Results
    ## -------------------------------------------------------------------------
    ##                            OLS       OLS       OLS       OLS     robust  
    ##                                                                  linear  
    ##                            (1)       (2)       (3)       (4)       (5)   
    ## -------------------------------------------------------------------------
    ## Intercept               -2.078***  -0.272    -0.546    -0.419     0.205  
    ##                          (0.159)   (0.642)   (0.643)   (0.642)   (0.645) 
    ## PTA                      0.350*     0.404    0.462*    0.465*    0.618** 
    ##                          (0.152)   (0.232)   (0.235)   (0.234)   (0.211) 
    ## GIM                     -0.606***  -0.391    -0.363    -0.375    -0.098  
    ##                          (0.163)   (0.221)   (0.222)   (0.220)   (0.212) 
    ## After 2005               -0.305    -0.130    -0.067    -0.080     0.049  
    ##                          (0.163)   (0.237)   (0.245)   (0.244)   (0.224) 
    ## Oligopsony               -0.023     0.008    -0.008    -0.004    -0.109  
    ##                          (0.072)   (0.075)   (0.074)   (0.073)   (0.058) 
    ## Obs. Num. (log)                   -0.546*** -0.539*** -0.540*** -0.688***
    ##                                    (0.100)   (0.099)   (0.099)   (0.127) 
    ## Yearly                            -0.788**  -0.760**  -0.783**  -0.951** 
    ##                                    (0.282)   (0.279)   (0.279)   (0.295) 
    ## USA                                0.548**   0.607**   0.542**   0.499** 
    ##                                    (0.182)   (0.187)   (0.188)   (0.185) 
    ## Europe                              0.014     0.007     0.004    -0.084  
    ##                                    (0.157)   (0.155)   (0.154)   (0.133) 
    ## Meat                                          0.191   0.565***   0.601** 
    ##                                              (0.127)   (0.169)   (0.193) 
    ## Tobacco                                      0.443*     0.397     0.281  
    ##                                              (0.208)   (0.207)   (0.193) 
    ## Beverages                                     0.222     0.170     0.119  
    ##                                              (0.164)   (0.166)   (0.152) 
    ## Dairy                                         0.145    0.473**   0.485*  
    ##                                              (0.133)   (0.163)   (0.189) 
    ## Oils                                         -0.100    -0.147    -0.348  
    ##                                              (0.171)   (0.175)   (0.187) 
    ## Fruits                                        0.167    0.529**   0.595** 
    ##                                              (0.142)   (0.173)   (0.190) 
    ## Cereals                                       0.247     0.170    -0.003  
    ##                                              (0.148)   (0.156)   (0.131) 
    ## Perishable                                            -0.450**  -0.588** 
    ##                                                        (0.168)   (0.186) 
    ## R-squared                 0.231     0.295     0.311     0.321            
    ## Residual standard error   0.700     0.673     0.671     0.667     0.538  
    ## F statistic             34.134*** 23.535*** 13.346*** 13.072***          
    ## -------------------------------------------------------------------------
    ## Notes:                  ***p < .001; **p < .01; *p < .05
